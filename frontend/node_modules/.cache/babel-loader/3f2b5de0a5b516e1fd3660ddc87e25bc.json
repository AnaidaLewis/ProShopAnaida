{"ast":null,"code":"import{useEffect,useState}from\"react\";import React from'react';import{useLocation,Link,useNavigate}from'react-router-dom';import{Button,Row,Col,ListGroup,Image,Card}from'react-bootstrap';import{useDispatch,useSelector}from\"react-redux\";import CheckoutSteps from\"../components/CheckoutSteps\";import Message from\"../components/Message\";import{createOrder}from'../actions/orderActions';import{ORDER_CREATE_RESET}from\"../constants/orderConstants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PlaceOrderScreen(){var orderCreate=useSelector(function(state){return state.orderCreate;});var order=orderCreate.order,error=orderCreate.error,success=orderCreate.success;var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});cart.itemsPrice=cart.cartItems.reduce(function(acc,item){return acc+item.price*item.qty;},0).toFixed(2);cart.shippingPrice=(cart.itemsPrice>100?0:10).toFixed(2);cart.taxPrice=(cart.itemsPrice*0.18).toFixed(2);cart.totalPrice=(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice)).toFixed(2);var navigate=useNavigate();useEffect(function(){if(!cart.paymentMethod){var payment_redirect='/payment';navigate(payment_redirect);}if(success){var pathname=\"/order/\".concat(order.id);navigate(pathname);dispatch({type:ORDER_CREATE_RESET});}},[success]);var placeOrder=function placeOrder(){dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:8,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Shipping: \"}),cart.shippingAddress.address,\",  \",cart.shippingAddress.city,'  ',cart.shippingAddress.postalCode,\",\",'  ',cart.shippingAddress.country]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Method: \"}),cart.paymentMethod]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Items\"}),cart.cartItems.length===0?/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"Your cart is empty\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cart.cartItems.map(function(item,index){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" X $\",item.price,\" = $\",(item.qty*item.price).toFixed(2)]})]})},index);})})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Item:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Shipping:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.shippingPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Total:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.totalPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block col-12\",disabled:cart.cartItems===0,onClick:placeOrder,children:\"Place Order\"})})]})})})]})]});}export default PlaceOrderScreen;","map":{"version":3,"names":["useEffect","useState","React","useLocation","Link","useNavigate","Button","Row","Col","ListGroup","Image","Card","useDispatch","useSelector","CheckoutSteps","Message","createOrder","ORDER_CREATE_RESET","PlaceOrderScreen","orderCreate","state","order","error","success","dispatch","cart","itemsPrice","cartItems","reduce","acc","item","price","qty","toFixed","shippingPrice","taxPrice","totalPrice","Number","navigate","paymentMethod","payment_redirect","pathname","id","type","placeOrder","orderItems","shippingAddress","address","city","postalCode","country","length","map","index","image","name","product"],"sources":["/Users/mac/Desktop/react_portfolio/react-portfolio-website-1/backend/frontend/src/screens/PlaceOrderScreen.js"],"sourcesContent":["import { useEffect, useState } from \"react\"\nimport React from 'react'\nimport {useLocation, Link, useNavigate} from 'react-router-dom'\nimport {Button, Row,Col, ListGroup, Image, Card } from 'react-bootstrap'\nimport { useDispatch, useSelector } from \"react-redux\"\nimport CheckoutSteps from \"../components/CheckoutSteps\";\nimport Message from \"../components/Message\";\nimport {createOrder} from '../actions/orderActions'\nimport { ORDER_CREATE_RESET } from \"../constants/orderConstants\"\n\nfunction PlaceOrderScreen() {\n\n  const orderCreate = useSelector(state => state.orderCreate)\n  const {order, error, success } = orderCreate\n\n  const dispatch = useDispatch()\n  const cart = useSelector(state => state.cart)\n\n  cart.itemsPrice = cart.cartItems.reduce((acc, item) => acc + item.price * item.qty, 0).toFixed(2)\n  cart.shippingPrice = (cart.itemsPrice > 100 ? 0 : 10).toFixed(2)\n  cart.taxPrice =  (cart.itemsPrice * (0.18)).toFixed(2)\n  cart.totalPrice = (Number(cart.itemsPrice) + Number(cart.shippingPrice) + Number(cart.taxPrice)).toFixed(2)\n  \n  let navigate = useNavigate();\n\n\n  useEffect(() => {\n\n  if (!cart.paymentMethod) {\n    let payment_redirect = '/payment'\n    navigate(payment_redirect)\n    }\n    if (success) {\n      let pathname = `/order/${order.id}`\n      navigate(pathname)\n      dispatch({ type: ORDER_CREATE_RESET })\n    }\n}, [success])\n\n\n  const placeOrder = () => {\n    dispatch(createOrder({\n      orderItems: cart.cartItems,\n      shippingAddress : cart.shippingAddress,\n      paymentMethod: cart.paymentMethod,\n      itemsPrice : cart.itemsPrice,\n      shippingPrice: cart.shippingPrice,\n      taxPrice: cart.taxPrice,\n      totalPrice: cart.totalPrice\n    }))\n\n  }\n  return (\n    <div>\n      <CheckoutSteps step1 step2 step3 step4 />\n      <Row>\n        <Col md = {8}>\n           <ListGroup variant = 'flush'>\n           <ListGroup.Item>\n              <h2>Shipping</h2>\n\n              <p>\n                  <strong>Shipping: </strong>\n                  {cart.shippingAddress.address},  {cart.shippingAddress.city}\n                  {'  '}\n                  {cart.shippingAddress.postalCode},\n                  {'  '}\n                  {cart.shippingAddress.country}\n              </p>\n          </ListGroup.Item>\n\n\n          <ListGroup.Item>\n              <h2>Payment Method</h2>\n\n              <p>\n                  <strong>Method: </strong>\n                  {cart.paymentMethod}\n              </p>\n          </ListGroup.Item>\n\n          <ListGroup.Item>\n              <h2>Order Items</h2>\n              {cart.cartItems.length === 0 ? <Message variant = 'info'>\n                Your cart is empty\n              </Message> : (\n                <ListGroup variant = 'flush'>\n                  {cart.cartItems.map((item, index) => (\n                    <ListGroup.Item key = {index}>\n                      <Row>\n                        <Col md = {1}>\n                          <Image src = {item.image} alt = {item.name} fluid rounded />\n                        </Col>\n\n                        <Col>\n                          <Link to = {`/product/${item.product}`}>{item.name}</Link>\n                        </Col>\n\n                        <Col md = {4}>\n                          {item.qty} X ${item.price} = ${(item.qty * item.price).toFixed(2)}\n                        </Col>\n                      </Row>\n                    </ListGroup.Item>\n                  ))}\n                </ListGroup>\n              )\n              \n            }\n          </ListGroup.Item>\n\n           </ListGroup>\n        </Col>\n\n        <Col md = {4}>\n            <Card>\n              <ListGroup variant = 'flush'>\n                <ListGroup.Item>\n                  <h2>Order Summary</h2>\n                </ListGroup.Item>\n\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Item:</Col>\n                    <Col>${cart.itemsPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Shipping:</Col>\n                    <Col>${cart.shippingPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Tax:</Col>\n                    <Col>${cart.taxPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Total:</Col>\n                    <Col>${cart.totalPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n\n                <ListGroup.Item>\n                  {error && <Message variant = 'danger'>{error}</Message>}\n\n                </ListGroup.Item>\n\n                <ListGroup.Item>\n                  <Button\n                  type = 'button'\n                  className = 'btn-block col-12'\n                  disabled = {cart.cartItems === 0}\n                  onClick = {placeOrder}\n                  >\n                    Place Order\n                  </Button>\n                </ListGroup.Item>\n              </ListGroup>\n            </Card>\n        </Col>\n      </Row>\n    </div>\n  )\n}\n\nexport default PlaceOrderScreen"],"mappings":"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"},"metadata":{},"sourceType":"module"}